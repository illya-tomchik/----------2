creatium.init.global(function(){function t(){var e=.01*Math.min(window.innerHeight,window.outerHeight);document.documentElement.style.setProperty("--vh",e+"px")}function x(i,n){var r;n=n||{width:360,height:640},(r="xs"===cr.screen?{$wrappers:i.find(".widget-stories-page > .layers-wrapper"),active:!1,handler:function(){var e=Math.min(window.innerHeight,window.outerHeight),t=Math.min(window.innerWidth,window.outerWidth);(t<n.width||e<n.height||t>n.width&&e>n.height)&&(e=Math.min(t/n.width,e/n.height),r.$wrappers.css({transform:"scale("+e+")"}))}}:{$el:i.find(".metahtml").filter(function(){return $(this).closest(".node")[0]===i.closest(".node")[0]}),active:!1,handler:function(){var e;i.is(".section")?(e=0,i.children(".padding_top, .padding_bottom, .metahtml").each(function(){e+=this.getBoundingClientRect().height})):e=i.outerHeight(!0);var t,n,o=Math.min(window.innerHeight,window.outerHeight);if(r.active)return r.$el.css({transform:"initial","margin-top":"initial"}),(n=i.data("api-swiper"))&&(n.params.touchRatio=1),r.active=!1,r.handler();o<e&&(t=r.$el.outerHeight(!0),t=1-(o=e-o)/t,(n=i.data("api-swiper"))?n.params.touchRatio=1/t:i.data("touchRatio",1/t),r.$el.css({transform:"scale("+t+")","transform-origin":"bottom","margin-top":"-"+o+"px"}),r.active=!0)}}).handler(),i.is(".modal-dialog")&&i.closest(".modal").on("show",r.handler),$(window).on("resize",function(){r.handler()})}t(),window.addEventListener("resize",t),/iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream&&980===window.innerWidth&&setTimeout(function e(){980===window.innerWidth?setTimeout(e,100):($(window).triggerHandler("resize"),t())},100),$(".section-stories-slider").each(function(){x($(this),$(this).data("size"))}),creatium.lazy.add($('.section-stories-slider, .modal[data-type="stories"]'),function e(n){if(!window.Swiper)return setTimeout(function(){e(n)},50);function o(){return t?$(this).closest(".node")[0]===n[0]:$(this).closest(".modal")[0]===n[0]}var t=n.is(".section"),i=!t,r=n.find(".swiper-container").filter(o),a=n.find("[cr-stories-highlight]").filter(o),s=n.find("[cr-stories-next]").filter(o),c=n.find("[cr-stories-previous]").filter(o),d=n.find("[cr-stories-page]").filter(o),l=n.find("[cr-stories-index]").filter(o),u=!0;t&&(u=n.hasClass("fullscreen-mode")),i&&x(n.children(".modal-dialog"),cr.closest(n,".node").data("size"));var g=_.map(a,function(e){var t={$pages:$(e).find("[cr-stories-page]").filter(o),$conts:$(e).find(".highlight-cont-wrapper > .cont").filter(o),index:0,auto:{progress:0,seconds:null,from:null,to:null},tap:function(e){w.reset(),t.$conts.eq(t.index).hide(),t.index=e,t.$conts.eq(t.index).show(),w.start()},progress:function(){t.$pages.slice(0,t.index).attr("style","--progress: 1"),t.$pages.eq(t.index).attr("style","--progress: "+t.auto.progress),t.$pages.slice(t.index+1).attr("style","--progress: 0")}};return t}),h=g[0];r.addClass("swiper-mode");var f=new Swiper(r.get(0),{autoHeight:!1,autoplay:!1,allowTouchMove:!0,centeredSlides:!0,slidesPerView:"auto",effect:"slide",touchEventsTarget:"container",mousewheelEventsTarged:"container",spaceBetween:30,touchRatio:(t?n:n.children(".modal-dialog")).data("touchRatio")||1,on:{slideChange:function(){a.filter(".is-active").removeClass("is-active"),a.eq(f.activeIndex).addClass("is-active"),l.text(f.activeIndex+1),f.oldActiveIndex=f.activeIndex,h=g[f.activeIndex],w.reset(),w.start()}}});n.data("api-swiper",f),a.on("touchstart",function(e){var t=['[cr-field="slider"]',".widget-before-after > .root"].join(", ");0<$(e.target).closest(t).length&&e.stopPropagation()});var p={$on:n.find("[cr-stories-pause]").filter(o).on("click",function(){p.enableConstant()}),$off:n.find("[cr-stories-resume]").filter(o).on("click",function(){p.disableConstant()}),active:!1,constant:!1,finger:!1,enableFinger:function(){p.finger=!0,p.render()},disableFinger:function(){p.finger=!1,p.render()},enableConstant:function(){p.constant=!0,p.render()},disableConstant:function(){p.constant=!1,p.render()},render:function(){p.active?p.finger||p.constant||(p.active=!1,p.$on.show(),p.$off.hide()):(p.finger||p.constant)&&(p.active=!0,p.$on.hide(),p.$off.show())}};a.on("touchstart mousedown",function(e){var t=["[cr-stories-pause]","[cr-stories-resume]","[cr-modal-close]"].join(", ");0<$(e.target).closest(t).length?e.stopPropagation():p.enableFinger()}),$(document).on("touchend mouseup",function(){p.disableFinger()});var w={start:function(){var e=h.$conts.eq(h.index).children(".node");e.data("auto")?h.auto.seconds=e.data("timeout"):h.auto.seconds=99999999,h.auto.from=(new Date).getTime(),h.auto.to=(new Date).getTime()+1e3*h.auto.seconds,w.tick()},reset:function(){h.auto.progress=0,h.auto.from=(new Date).getTime(),h.auto.to=h.auto.from+1e3*h.auto.seconds},pause:function(){h.auto.from=(new Date).getTime()-1e3*h.auto.seconds*h.auto.progress,h.auto.to=(new Date).getTime()+1e3*h.auto.seconds*(1-h.auto.progress),h.progress()},tick:function(){if(setTimeout(w.tick,25),null!==h.auto.to)return p.active||!1===w.viewportTest()||!1===w.formTest()?w.pause():cr.modals.list.length>(i?1:0)||0<$(".fancybox-container").length?w.reset():(h.auto.progress=1-(h.auto.to-(new Date).getTime())/(h.auto.to-h.auto.from),h.auto.progress=Math.round(1e3*h.auto.progress)/1e3,h.progress(),void(1<=h.auto.progress&&n.trigger("tapnext")))},viewportTest:function(){var e=n[0].getBoundingClientRect(),t=window.innerHeight||document.documentElement.clientHeight;return e.top<=t&&200<=e.top+e.height},formTest:function(){return 0===$(document.activeElement).closest(".form, [data-form]").length}};w.start(),n.on("tapnext",function(e){f.animating||(h.index===h.$conts.length-1?n.trigger("slidenext"):h.tap(h.index+1))}),n.on("tapprev",function(e){f.animating||(0===h.index?n.trigger("slideprev"):h.tap(h.index-1))}),n.on("slidenext",function(e){f.isEnd||f.slideNext(),e.stopPropagation()}),n.on("slideprev",function(e){f.slidePrev(),e.stopPropagation()}),s.on("click",function(){n.trigger("tapnext")}),c.on("click",function(){n.trigger("tapprev")}),d.on("click",function(){h.tap($(this).index())}),r.on("click",".passive-conts-overlay",function(e){e=$(e.target).closest(".swiper-slide").index();f.slideTo(e)});var m,v=["a","input","textarea","select","button",".widget-before-after > .root","[cr-video-button]","[cr-slider-previous]","[cr-slider-next]","[cr-slider-page]","[cr-stories-previous]","[cr-stories-next]","[cr-stories-page]","[cr-stories-pause]","[cr-stories-resume]","[cr-spoiler-toggle]","[cr-hover]",".macros-map"].join(", ");f.browser.ie?r[0].removeEventListener("touchstart",f.onTouchStart,!1):(r[0].removeEventListener("touchstart",f.onTouchStart,{passive:!0,capture:!1}),r[0].removeEventListener("mousedown",f.onTouchStart,!1)),f.oldOnTouchStart=f.onTouchStart,f.onTouchStart=function(e){0===$(e.target).closest(v).length&&f.oldOnTouchStart(e)},f.browser.ie?r[0].addEventListener("touchstart",f.onTouchStart,!1):(r[0].addEventListener("touchstart",f.onTouchStart,{passive:!0,capture:!1}),r[0].addEventListener("mousedown",f.onTouchStart,!1)),"xs"===cr.screen&&(window.addEventListener("contextmenu",function(e){cr.modals.list.length>(i?1:0)||e.preventDefault()}),r.on("click",".swiper-slide",function(e){var t;0<$(e.target).closest(v).length||(t=e.currentTarget.getBoundingClientRect(),e.clientX>t.x+t.width/4?n.triggerHandler("tapnext"):n.triggerHandler("tapprev"))})),u&&($("#powered-by").detach(),$(document).on("keydown",function(e){cr.modals.list.length>(i?1:0)||0<$(".fancybox-container").length||$(e.target).closest("input:focus, textarea").length||("ArrowLeft"===e.key?n.triggerHandler("tapprev"):"ArrowRight"===e.key&&n.triggerHandler("tapnext"))}),"xs"===cr.screen&&(m={$el:n.find("[cr-stories-hint]").filter(o),active:!1,xDown:null,yDown:null},n.on("touchstart",function(e){0<$(e.target).closest(v).length||(e=e.originalEvent.touches[0],m.xDown=e.clientX,m.yDown=e.clientY)}),n.on("touchend",function(e){m.xDown=null,m.yDown=null}),n.on("touchmove",function(e){var t;!m.active&&m.xDown&&m.yDown&&(t=e.originalEvent.touches[0].clientX,e=e.originalEvent.touches[0].clientY,t=m.xDown-t,e=m.yDown-e,(50<Math.abs(t)||50<Math.abs(e))&&(Math.abs(t)>Math.abs(e)||(m.active=!0,m.$el.fadeIn(300,function(){setTimeout(function(){m.$el.fadeOut(300,function(){m.active=!1})},500)})),m.xDown=null,m.yDown=null))})))})});